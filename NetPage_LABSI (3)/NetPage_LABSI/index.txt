 <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=windows-1252">
	<TITLE></TITLE>
	<META NAME="GENERATOR" CONTENT="OpenOffice 4.1.0  (Win32)">
	<META NAME="CREATED" CONTENT="0;0">
	<META NAME="CHANGEDBY" CONTENT="Lino Figueiredo">
	<META NAME="CHANGED" CONTENT="20140530;20525176">
	<META NAME="CHANGEDBY" CONTENT="Lino Figueiredo">
	<META NAME="CHANGEDBY" CONTENT="José Puga">
	<META NAME="CHANGEDBY" CONTENT="José Puga">
	<META NAME="CHANGEDBY" CONTENT="José Puga">
	<META NAME="CHANGEDBY" CONTENT="José Puga">
	<META NAME="CHANGEDBY" CONTENT="José Puga">
	<META NAME="CHANGEDBY" CONTENT="José Puga">
	<STYLE TYPE="text/css">
	<!--
		@page { margin: 2.01cm }
		TD P { margin-bottom: 0cm }
		P { margin-bottom: 0.2cm }
		A:link { so-language: zxx }
	-->
	</STYLE>
</HEAD>
<BODY LANG="pt-BR" DIR="LTR">
<TABLE WIDTH=100% BORDER=0 CELLPADDING=0 CELLSPACING=0 STYLE="page-break-before: always">
	<COL WIDTH=15*>
	<COL WIDTH=7*>
	<COL WIDTH=18*>
	<COL WIDTH=38*>
	<COL WIDTH=37*>
	<COL WIDTH=13*>
	<COL WIDTH=25*>
	<COL WIDTH=38*>
	<COL WIDTH=23*>
	<COL WIDTH=9*>
	<COL WIDTH=19*>
	<COL WIDTH=15*>
	<TR VALIGN=TOP>
		<TD COLSPAN=2 WIDTH=9% BGCOLOR="#0099ff" SDVAL="0" SDNUM="2070;1046;@">
			<P ALIGN=LEFT STYLE="margin-bottom: 0.51cm; border: none; padding: 0cm">
			<BR><BR>
			</P>
			<P ALIGN=LEFT STYLE="margin-bottom: 0.51cm; border: none; padding: 0cm">
			<BR><BR>
			</P>
			<P ALIGN=LEFT><BR>
			</P>
		</TD>
		<TD COLSPAN=7 WIDTH=75% BGCOLOR="#0099ff" SDVAL="0" SDNUM="2070;1046;@">
			<P ALIGN=LEFT STYLE="margin-bottom: 0.51cm; border: none; padding: 0cm">
			<BR><BR>
			</P>
			<P ALIGN=LEFT STYLE="border-top: none; border-bottom: 1.00pt solid #000000; border-left: none; border-right: none; padding-top: 0cm; padding-bottom: 0.08cm; padding-left: 0cm; padding-right: 0cm; text-decoration: none"><A NAME="In&iacute;cio"></A>
			<FONT COLOR="#ffffff"><FONT FACE="Thorndale, serif"><FONT SIZE=6><I><B>AGV Seguidor de Linha</B></I></FONT></FONT></FONT></P>
		</TD>
		<TD ROWSPAN=4 COLSPAN=3 WIDTH=17% BGCOLOR="#0099ff" SDVAL="0" SDNUM="2070;1046;@">
			<P ALIGN=LEFT STYLE="margin-bottom: 0.51cm; border: none; padding: 0cm">
			<BR><BR>
			</P>
			<P ALIGN=CENTER STYLE="margin-bottom: 0.51cm; background: transparent; border: none; padding: 0cm; text-decoration: none">
			<IMG SRC="image002.jpg" NAME="graphics1" ALIGN=RIGHT WIDTH=231 HEIGHT=110 BORDER=0><BR CLEAR=RIGHT><FONT COLOR="#ffffff"><FONT FACE="Thorndale, serif"><FONT SIZE=4 STYLE="font-size: 16pt"><I><B>LABSIS</B></I></FONT></FONT></FONT></P>
			<P ALIGN=CENTER STYLE="margin-bottom: 0.51cm; background: transparent; border: none; padding: 0cm; text-decoration: none">
			<FONT COLOR="#ffffff"><FONT FACE="Thorndale, serif"><FONT SIZE=3><I><B>2025/2026</B></I></FONT></FONT></FONT></P>
			<P ALIGN=CENTER><BR>
			</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD COLSPAN=9 WIDTH=83% HEIGHT=34 BGCOLOR="#0099ff" SDVAL="0" SDNUM="2070;1046;@">
			<P ALIGN=LEFT STYLE="border: none; padding: 0cm; text-decoration: none">
			<FONT COLOR="#ffffff"><FONT FACE="Thorndale, serif"><FONT SIZE=4><I><B>Autores:</B></I></FONT></FONT></FONT></P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=6% BGCOLOR="#0099ff" SDVAL="0" SDNUM="2070;1046;@">
			<P ALIGN=LEFT><BR>
			</P>
		</TD>
		<TD COLSPAN=5 WIDTH=44% BGCOLOR="#0099ff" SDVAL="0" SDNUM="2070;1046;@">
			<P ALIGN=LEFT STYLE="border: none; padding: 0cm; text-decoration: none">
			<FONT COLOR="#000000"><FONT FACE="Thorndale, serif"><FONT SIZE=1 STYLE="font-size: 8pt"><I><B><FONT COLOR="#ffffff"><FONT SIZE=3>João Pedro Ribero 				Bastos 1211352 
			</FONT></FONT> </B></I></FONT></FONT></FONT>
			</P>
		</TD>
		<TD COLSPAN=3 WIDTH=33% BGCOLOR="#0099ff" SDVAL="0" SDNUM="2070;1046;@">
			<P ALIGN=LEFT STYLE="border: none; padding: 0cm; text-decoration: none">
			<FONT COLOR="#ffffff"><FONT FACE="Thorndale, serif"><FONT SIZE=3><I><B>1211352@isep.ipp.pt</B></I></FONT></FONT></FONT></P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=6% BGCOLOR="#0099ff" SDVAL="0" SDNUM="2070;1046;@">
			<P ALIGN=LEFT><BR>
			</P>
		</TD>
		<TD COLSPAN=5 WIDTH=44% BGCOLOR="#0099ff" SDVAL="0" SDNUM="2070;1046;@">
			<P ALIGN=LEFT STYLE="border: none; padding: 0cm; text-decoration: none">
			<FONT COLOR="#000000"><FONT FACE="Thorndale, serif"><FONT SIZE=3><I><B><FONT COLOR="#ffffff">Pedro Coelho 1200761
			</FONT> </B></I></FONT></FONT></FONT>
			</P>
		</TD>
		<TD COLSPAN=3 WIDTH=33% BGCOLOR="#0099ff">
			<P ALIGN=LEFT STYLE="margin-bottom: 0.51cm; border: none; padding: 0cm; text-decoration: none">
			<FONT COLOR="#ffffff"><FONT FACE="Thorndale, serif"><FONT SIZE=3><I><B>1200761@isep.ipp.pt</B></I></FONT></FONT></FONT></P>
			<P ALIGN=LEFT><BR>
			</P>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=3 WIDTH=16% HEIGHT=12 BGCOLOR="#ffffff" SDVAL="0" SDNUM="2070;1046;@">
			<P ALIGN=CENTER STYLE="border: none; padding: 0cm"><A HREF="#Introdu&ccedil;&atilde;o"><FONT COLOR="#000000"><SPAN STYLE="text-decoration: none"><FONT FACE="Thorndale, serif"><FONT SIZE=3><SPAN LANG="pt-BR"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">Introdu&ccedil;&atilde;o</SPAN></SPAN></SPAN></FONT></FONT></SPAN></FONT></A></P>
		</TD>
		<TD WIDTH=15% BGCOLOR="#ffffff" SDVAL="0" SDNUM="2070;1046;@">
			<P ALIGN=CENTER STYLE="border: none; padding: 0cm"><A HREF="#Arquitetura"><FONT COLOR="#000000"><SPAN STYLE="text-decoration: none"><FONT FACE="Thorndale, serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">Arquitetura</SPAN></SPAN></FONT></FONT></SPAN></FONT></A></P>
		</TD>
		<TD WIDTH=14% BGCOLOR="#ffffff" SDVAL="0" SDNUM="2070;1046;@">
			<P ALIGN=CENTER STYLE="border: none; padding: 0cm"><A HREF="#Hardware"><FONT COLOR="#000000"><SPAN STYLE="text-decoration: none"><FONT FACE="Thorndale, serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">Hardware</SPAN></SPAN></FONT></FONT></SPAN></FONT></A></P>
		</TD>
		<TD COLSPAN=2 WIDTH=15% BGCOLOR="#ffffff" SDVAL="0" SDNUM="2070;1046;@">
			<P ALIGN=CENTER STYLE="border: none; padding: 0cm"><A HREF="#Software"><FONT COLOR="#000000"><SPAN STYLE="text-decoration: none"><FONT FACE="Thorndale, serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">Software</SPAN></SPAN></FONT></FONT></SPAN></FONT></A></P>
		</TD>
		<TD WIDTH=15% BGCOLOR="#ffffff" SDVAL="0" SDNUM="2070;1046;@">
			<P ALIGN=CENTER STYLE="border: none; padding: 0cm"><A HREF="#Resultados"><FONT COLOR="#000000"><SPAN STYLE="text-decoration: none"><FONT FACE="Thorndale, serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">Resultados</SPAN></SPAN></FONT></FONT></SPAN></FONT></A></P>
		</TD>
		<TD COLSPAN=2 WIDTH=12% BGCOLOR="#ffffff" SDVAL="0" SDNUM="2070;1046;@">
			<P ALIGN=CENTER STYLE="border: none; padding: 0cm"><A HREF="#Conclus&otilde;es"><FONT COLOR="#000000"><SPAN STYLE="text-decoration: none"><FONT FACE="Thorndale, serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">Conclus&otilde;es</SPAN></SPAN></FONT></FONT></SPAN></FONT></A></P>
		</TD>
		<TD COLSPAN=2 WIDTH=13% BGCOLOR="#ffffff" SDVAL="0" SDNUM="2070;1046;@">
			<P ALIGN=CENTER STYLE="border: none; padding: 0cm"><A HREF="#Refer&ecirc;ncias"><FONT COLOR="#000000"><SPAN STYLE="text-decoration: none"><FONT FACE="Thorndale, serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">Refer&ecirc;ncias</SPAN></SPAN></FONT></FONT></SPAN></FONT></A></P>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=12 WIDTH=100% BGCOLOR="#ffffff" SDNUM="2070;1046;@">
			<P ALIGN=CENTER STYLE="background: #0099ff"><BR>
			</P>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=12 WIDTH=100% BGCOLOR="#eeeeee">
			<P ALIGN=CENTER STYLE="margin-bottom: 0.5cm; background: #eeeeee"><BR><BR>
			</P>
			<p align="center" style="background: #eeeeee">
  			<a href="carrinho.JPEG">
    			<img src="carrinho.JPEG" alt="AGV seguidor de linha" width="360" border="0"> 
 			 </a>
			</p>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD COLSPAN=11 WIDTH=94%>
			<UL>
				<LI><P ALIGN=LEFT STYLE="background: #0099ff; border: none; padding: 0cm"><A NAME="Introdu&ccedil;&atilde;o"></A>
				<SDFIELD TYPE=DOCINFO SUBTYPE=TITLE></SDFIELD><FONT FACE="Thorndale, serif"><FONT SIZE=4><SPAN STYLE="font-style: normal">Introdu&ccedil;&atilde;o</SPAN></FONT></FONT></P>
			</UL>
		</TD>
		<TD WIDTH=6%>
			<P ALIGN=CENTER STYLE="border: none; padding: 0cm"><A HREF="#In&iacute;cio"><FONT COLOR="#000000"><SPAN STYLE="text-decoration: none"><FONT FACE="Thorndale, serif"><FONT SIZE=2><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">In&iacute;cio</SPAN></SPAN></FONT></FONT></SPAN></FONT></A></P>
		</TD>
	</TR>
	<TR>
<TD COLSPAN=12 WIDTH=100% VALIGN=TOP BGCOLOR="#eeeeee">

    <P ALIGN=LEFT STYLE="margin-bottom: 0.51cm; border: none; padding: 0cm">
    Este projeto foi desenvolvido no âmbito da unidade curricular de Laboratório de Sistemas do curso de Engenharia Eletrotécnica e de Computadores do Instituto Superior de Engenharia do Porto. O objetivo foi conceber e implementar um veículo guiado automaticamente seguidor de linha, baseado no microcontrolador ATmega328P, capaz de seguir de forma autónoma uma pista preta sobre fundo branco.
    </P>

<P ALIGN=LEFT STYLE="margin-bottom: 0.51cm; border: none; padding: 0cm">
De forma mais concreta, o sistema desenvolvido pretende:
</P>

<UL>
  <LI><P ALIGN=LEFT STYLE="margin-bottom: 0.2cm; border: none; padding: 0cm">
  Seguir a linha de forma totalmente autónoma ao longo da pista de ensaio.
  </P></LI>
  <LI><P ALIGN=LEFT STYLE="margin-bottom: 0.2cm; border: none; padding: 0cm">
  Manter uma velocidade de deslocação aproximadamente constante, mesmo com variações de carga da bateria e diferenças entre os motores.
  </P></LI>
  <LI><P ALIGN=LEFT STYLE="margin-bottom: 0.2cm; border: none; padding: 0cm">
  Utilizar encoders óticos nas rodas e um controlador PI para regular a velocidade de cada motor.
  </P></LI>
</UL>





    <P ALIGN=LEFT STYLE="margin-bottom: 0.51cm; border: none; padding: 0cm">
    Ao longo do desenvolvimento foram aplicados conceitos de eletrónica digital, conversão analógico digital, controlo por PWM, temporização e utilização de interrupções, integrando num único sistema os vários temas abordados na unidade curricular.
    </P>

    <P ALIGN=LEFT STYLE="margin-bottom: 0.51cm; border: none; padding: 0cm">
    Antes de descrever em detalhe a solução implementada é importante enquadrar o projeto no contexto do estado da arte dos veículos guiados automaticamente e dos seguidores de linha didáticos.
    </P>
<P ALIGN=LEFT STYLE="margin-bottom: 0.3cm">
    <FONT FACE="Thorndale, serif"><FONT SIZE=3><B>Estado da Arte</B></FONT></FONT>
</P>

    <P ALIGN=LEFT STYLE="margin-bottom: 0.51cm; background: #eeeeee">
    Nestas últimas décadas os veículos guiados automaticamente têm sido amplamente utilizados em ambientes industriais e logísticos, nomeadamente em armazéns, linhas de produção e sistemas de transporte interno. Estes veículos seguem percursos previamente definidos e são capazes de se deslocar de forma autónoma, reduzindo a necessidade de intervenção humana em tarefas repetitivas.
    </P>

    <P ALIGN="CENTER">
        <IMG SRC="AGVexemplo.JPG" ALT="Exemplo de AGV industrial" WIDTH="300"><BR>
        <SPAN STYLE="font-size: 10pt">Figura X – Exemplo de um AGV industrial</SPAN>
    </P>

    <P ALIGN=LEFT STYLE="margin-bottom: 0.51cm; border: none; padding: 0cm">
    Numa vertente mais simples existem diversos projetos didáticos de seguidores de linha que utilizam microcontroladores de baixo custo para introduzir conceitos de eletrónica digital, sensores e controlo. A maioria destes sistemas recorre a sensores óticos para distinguir o contraste entre a linha e o fundo e utiliza motores de corrente contínua comandados por um driver de potência. Em muitos exemplos o controlo é feito apenas com base na leitura dos sensores de linha sem realimentação da velocidade das rodas.
    </P>

    <P ALIGN="CENTER">
        <IMG SRC="SLexemplo.JPG" ALT="Seguidor de linha didático" WIDTH="300"><BR>
        <SPAN STYLE="font-size: 10pt">Figura X – Exemplo de seguidor de linha didático semelhante ao desenvolvido neste projeto</SPAN>
    </P>

    <P ALIGN=LEFT STYLE="margin-bottom: 0.51cm; border: none; padding: 0cm">
    Em trabalhos mais avançados começa a ser comum a utilização de encoders incrementais nas rodas, o que permite estimar a velocidade angular e implementar esquemas de controlo de velocidade em malha fechada. Esta abordagem melhora a estabilidade do movimento e reduz diferenças de comportamento entre motores, especialmente em curvas apertadas ou em situações em que o atrito com o piso varia.
    </P>

    <P ALIGN=LEFT STYLE="margin-bottom: 0.51cm; border: none; padding: 0cm">
    O projeto apresentado neste relatório enquadra se neste contexto de seguidores de linha didáticos, incorporando no entanto algumas características típicas de sistemas mais completos. Para além do uso de um conjunto de sensores infravermelhos para deteção da fita no chão foi utilizada realimentação com encoders para controlo da velocidade de cada roda. Desta forma é possível aproximar o comportamento do veículo ao de um AGV real, explorando simultaneamente conceitos de eletrónica, aquisição de sinal e controlo em tempo real.
    </P>
   <P ALIGN="CENTER">
        <IMG SRC="carrinho.JPEG" ALT="Exemplo de AGV industrial" WIDTH="300"><BR>
        <SPAN STYLE="font-size: 10pt">Figura X – Foto do projeto final</SPAN>
    </P>


</TD>


			</P>

			<P ALIGN=LEFT><BR>
			</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD COLSPAN=11 WIDTH=94%>
			<UL>
				<LI><P ALIGN=LEFT STYLE="background: #0099ff; border: none; padding: 0cm"><A NAME="Arquitetura"></A>
				<FONT SIZE=4>Arquitetura</FONT></P>
			</UL>
		</TD>
		<TD WIDTH=6%>
			<P ALIGN=CENTER STYLE="border: none; padding: 0cm"><A HREF="#In&iacute;cio"><FONT COLOR="#000000"><SPAN STYLE="text-decoration: none"><FONT FACE="Thorndale, serif"><FONT SIZE=2><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">In&iacute;cio</SPAN></SPAN></FONT></FONT></SPAN></FONT></A></P>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=12 WIDTH=100% VALIGN=TOP BGCOLOR="#eeeeee">
			<P ALIGN=LEFT STYLE="margin-bottom: 0.51cm; border: none; padding: 0cm">
			A arquitectura do AGV está organizada em vários blocos principais:
bateria e alimentação,
microcontrolador,
sensores de linha,
encoders das rodas
e estágio de potência para os motores.
A Figura X apresenta o diagrama de blocos do sistema.
	<P ALIGN="CENTER">
        <IMG SRC="blocos1.PNG" ALT="Exemplo de AGV industrial" WIDTH="500"><BR>
        <SPAN STYLE="font-size: 10pt">Figura X – Diagrama de blocos da arquitetura do projeto </SPAN>
    </P>

			<ul>
  <li><strong>Sensores IR</strong>: leitura analógica por <strong>ADC</strong> (5 canais) para cálculo do erro de linha.</li>
  <li><strong>Encoders</strong>: contagem de impulsos por <strong>INT0</strong> e <strong>INT1</strong>.</li>
  <li><strong>Motores</strong>: comando por <strong>PWM</strong> e sinais de <strong>direção</strong> aplicados ao <strong>L293D</strong>.</li>
  <li><strong>Temporização</strong>: timers para definir o período de amostragem do controlo e tarefas auxiliares de debug.</li>
</ul>

			<P ALIGN=LEFT STYLE="margin-bottom: 0.51cm">
A bateria LiPo 3S fornece aproximadamente 11,1 V (VBAT), tensão que alimenta diretamente o estágio de potência do sistema, nomeadamente a ponte H (L293D) para acionamento dos motores. Em paralelo, a bateria alimenta um regulador de tensão que gera 5 V para a eletrónica de controlo, incluindo o ATmega328P, o módulo de sensores infravermelhos, os encoders óticos e a alimentação lógica do driver. Todos os blocos partilham uma massa comum, garantindo uma referência elétrica consistente para medições e sinais de controlo.
			</P>
			<P ALIGN=LEFT STYLE="margin-bottom: 0.51cm">
O controlo é organizado em duas camadas. Na camada superior, o robot estima a posição da linha com base nos cinco sensores IR e calcula um erro de alinhamento relativamente ao centro do robot. Esse erro é convertido em duas referências de velocidade, uma para a roda esquerda e outra para a roda direita. Na camada inferior, um controlador PI de velocidade usa a realimentação dos encoders para ajustar o PWM de cada motor, de forma a que a velocidade medida siga a referência definida pela camada de seguimento de linha.
			</P>
			<P ALIGN=LEFT STYLE="margin-bottom: 0.51cm">
			As interfaces entre blocos são implementadas com os periféricos do ATmega328P: os sensores de linha são lidos por entradas ADC, os encoders são contados por interrupções externas (INT0 e INT1), e os motores são comandados por PWM gerado por temporizadores e aplicado ao L293D, em conjunto com sinais digitais de direção.
			</P>

		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD COLSPAN=11 WIDTH=94%>
			<UL>
				<LI><P ALIGN=LEFT STYLE="background: #0099ff; border: none; padding: 0cm"><A NAME="Hardware"></A>
				<FONT SIZE=4>Hardware</FONT></P>
			</UL>
		</TD>
		<TD WIDTH=6%>
			<P ALIGN=CENTER STYLE="border: none; padding: 0cm"><A HREF="#In&iacute;cio"><FONT COLOR="#000000"><SPAN STYLE="text-decoration: none"><FONT FACE="Thorndale, serif"><FONT SIZE=2><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">In&iacute;cio</SPAN></SPAN></FONT></FONT></SPAN></FONT></A></P>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=12 WIDTH=100% VALIGN=TOP BGCOLOR="#eeeeee">
<P ALIGN="CENTER">
   			<IMG SRC="breadboard.JPEG" ALT="Sensores seguidor de linha" WIDTH="300">
      			<BR>
      			<SPAN STYLE="font-size: 10pt">Figura X – Foto da breadboard com todos os componentes</SPAN>
			</P>

<h3>Alimentação</h3>
			<P ALIGN=LEFT STYLE="margin-bottom: 0.51cm; border: none; padding: 0cm">
			O robot é alimentado por uma bateria LiPo 3S, com tensão nominal de 11,1 V. Esta tensão é utilizada no estágio de potência dos motores, através da ponte H L293D. Para alimentar o microcontrolador e a restante eletrónica de controlo é usado um regulador de tensão linear LM7805, que reduz a tensão da bateria para 5 V.
A opção por um regulador linear simplifica o circuito e facilita a integração em protótipo. No entanto, implica maior dissipação térmica quando a bateria está totalmente carregada, pelo que é importante garantir uma corrente dentro dos limites do regulador e considerar dissipação adequada durante funcionamento prolongado.

			<P ALIGN="CENTER">
   			<IMG SRC="BATERIA.JPG" ALT="Microcontrolador ATmega8P montado na breadboard" WIDTH="300">
      			<BR>
      			<SPAN STYLE="font-size: 10pt">Figura X – Bateria LiPo 3S 11,6v</SPAN>
<h3>Microcontrolador</h3>
			<P ALIGN=LEFT STYLE="margin-bottom: 0.51cm">
O núcleo de processamento é um ATmega328P montado em breadboard, com cristal de
16 MHz. Este microcontrolador fornece conversão analógico digital de 10 bits,
módulos de PWM por hardware, temporizadores de 8 e 16 bits e duas entradas de
interrupção externa, suficientes para ler os sensores, os encoders e gerar os
sinais de controlo dos motores.
			<P ALIGN="CENTER">
   			<IMG SRC="ATMega8-Pin-Diagram.PNG" ALT="Microcontrolador ATmega8P montado na breadboard" WIDTH="300">
      			<BR>
      			<SPAN STYLE="font-size: 10pt">Figura X – Microcontrolador ATmega88 no sistema</SPAN>
    			
			</P>
<h3>Regulador de tensão</h3>
			<P ALIGN=LEFT STYLE="margin-bottom: 0.51cm">
Como já foi dito acima, para fornecer 5 V ao microcontrolador e aos periféricos foi utilizado um regulador linear LM7805. O regulador recebe a tensão da bateria LiPo 3S (tipicamente entre cerca de 11 V e 12,0 V) e disponibiliza uma saída estabilizada de 5 V para a eletrónica de controlo, incluindo o ATmega88P, o módulo de sensores de linha e os encoders.Por se tratar de um regulador linear, parte da energia é dissipada sob a forma de calor, proporcionalmente à diferença entre a tensão de entrada e os 5 V de saída, bem como à corrente consumida. Na prática, esta solução foi suficiente para o protótipo, desde que respeitados os limites de corrente e assegurada massa comum em todo o sistema.
			<P ALIGN="CENTER">
   			<IMG SRC="Regulador.JPG" ALT="Regulador de tensão" WIDTH="300">
      			<BR>
      			<SPAN STYLE="font-size: 10pt">Figura X – Regulador de tensão L7805</SPAN>
			</P>
<h3>Sensores</h3>
			<P ALIGN=LEFT STYLE="margin-bottom: 0.51cm">
Para detetar a fita preta no chão foi utilizado um módulo com cinco sensores óticos alinhados do tipo TCRT5000, montado na parte frontal inferior do robô. Cada sensor integra um emissor de infravermelhos e um fototransístor, permitindo distinguir entre superfícies claras e escuras através da luz refletida. As saídas dos cinco sensores são analógicas e estão ligadas às entradas ADC do ATmega328P, nas portas PC0 a PC4.
Durante a fase de calibração foram medidos os níveis de tensão correspondentes à superfície branca e à fita preta, o que permitiu definir um limiar adequado no código. A partir das leituras dos cinco canais é calculada a posição relativa da linha em relação ao centro do robô, aplicando pesos diferentes a cada sensor. Este valor de desvio é depois usado pelo controlador para ajustar a velocidade de cada roda e manter o AGV alinhado com a trajetória.
			<P ALIGN="CENTER">
   			<IMG SRC="sensor.JPG" ALT="Sensores seguidor de linha" WIDTH="300">
      			<BR>
      			<SPAN STYLE="font-size: 10pt">Figura X – Módulo de 5 sensores TCRT5000</SPAN>
			</P>
<h3>LEDs</h3>
			<P ALIGN=LEFT STYLE="margin-bottom: 0.51cm">
Foram utilizados dois LEDs como elementos simples de sinalização e apoio à depuração do sistema. Um LED é gerado por temporização e pisca a 1000 Hz, conforme requisito do projeto, servindo como confirmação visual de que o firmware está em execução e que a temporização está ativa. Este mesmo LED foi também útil durante testes de debug, por exemplo para validar rotinas associadas aos encoders e ao ciclo de controlo.
</p>

<p>
O segundo LED é utilizado como indicador de deteção de linha. Sempre que o sistema deteta a linha preta através do módulo de sensores IR, este LED acende, permitindo verificar rapidamente a leitura dos sensores durante a calibração e durante os testes na pista.
</p>
			
			<P ALIGN="CENTER">
   			<IMG SRC="LEDS.PNG" ALT="Sensores seguidor de linha" WIDTH="300">
      			<BR>
      			<SPAN STYLE="font-size: 10pt">Figura X – LEDs </SPAN>
			</P>

			
<h3>Encoders de velocidade</h3>
			<P ALIGN=LEFT STYLE="margin-bottom: 0.51cm">
Cada motor está equipado com um disco fendido acoplado ao eixo, com 20 aberturas, e com um sensor ótico que funciona como encoder incremental. Sempre que uma das fendas do disco passa em frente ao sensor, é gerado um impulso digital. Os sinais dos dois encoders estão ligados às entradas de interrupção externa INT0 e INT1 do ATmega328P nas portas PD2 e PD3, respetivamente.
O microcontrolador conta estes impulsos ao longo de uma janela de tempo fixa, definida por um temporizador, e a partir do número de pulsos por intervalo é calculada a velocidade angular de cada roda. Conhecendo o número de fendas por volta é possível converter o número de pulsos em rotações por segundo ou rotações por minuto. Esta medição da velocidade real é usada pelo controlador para ajustar o sinal PWM enviado à ponte H e compensar diferenças entre motores, garantindo que as duas rodas seguem a mesma velocidade desejada e permitindo um seguimento mais estável da linha.

			<P ALIGN="CENTER">
   			<IMG SRC="encoders.JPG" ALT="Encoders" WIDTH="300">
      			<BR>
      			<SPAN STYLE="font-size: 10pt">Figura X – Encoders</SPAN>
		

			</P>
<h3>Motores</h3>
			<P ALIGN=LEFT STYLE="margin-bottom: 0.51cm">
A tracção é assegurada por dois motores de corrente contínua com caixa de engrenagens.
Os motores são comandados por um circuito integrado L293D que implementa duas pontes H.
O ATmega328P gera sinais PWM no Timer0 para controlar a velocidade e usa pinos digitais
para definir o sentido de rotação de cada motor. Nesta implementação o robot circula
sempre para a frente, e as curvas são obtidas através da diferença de velocidade entre
as rodas esquerda e direita.

			<P ALIGN="CENTER">
   			<IMG SRC="motores.JPG" ALT="Encoders" WIDTH="300">
      			<BR>
      			<SPAN STYLE="font-size: 10pt">Figura X – Motores</SPAN>

			</P>
			<P ALIGN=LEFT><BR>
			</P>

<h3>Ponte H</h3>
			<P ALIGN=LEFT STYLE="margin-bottom: 0.51cm">
Para efetuar o controlo dos motores foi utilizada uma ponte H do tipo L293D. Este circuito integrado funciona como etapa de potência entre o microcontrolador ATmega328P e os motores de corrente contínua, permitindo tanto o controlo do sentido de rotação como da velocidade de cada roda.
As entradas de controlo do L293D estão ligadas a pinos digitais do microcontrolador, responsáveis por definir se cada motor roda para a frente ou para trás.
O L293D recebe a alimentação lógica a 5 V proveniente do regulador e uma alimentação separada para potência, ligada à linha de alimentação dos motores. Desta forma o microcontrolador fica protegido das correntes mais elevadas exigidas pelos motores e é garantido que o AGV consegue arrancar e corrigir a trajetória sem sobrecarregar os pinos do ATmega88.

			<P ALIGN="CENTER">
   			<IMG SRC="ponteH.JPG" ALT="Encoders" WIDTH="300">
      			<BR>
      			<SPAN STYLE="font-size: 10pt">Figura X – Ponte H L293D</SPAN>

			</P>
			<P ALIGN=LEFT><BR>
			</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD COLSPAN=11 WIDTH=94%>
			<UL>
				<LI><P ALIGN=LEFT STYLE="background: #0099ff; border: none; padding: 0cm"><A NAME="Software"></A>
				<FONT SIZE=4>Software</FONT></P>
			</UL>
		</TD>
		<TD WIDTH=6%>
			<P ALIGN=CENTER STYLE="border: none; padding: 0cm"><A HREF="#In&iacute;cio"><FONT COLOR="#000000"><SPAN STYLE="text-decoration: none"><FONT FACE="Thorndale, serif"><FONT SIZE=2><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">In&iacute;cio</SPAN></SPAN></FONT></FONT></SPAN></FONT></A></P>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=12 WIDTH=100% VALIGN=TOP BGCOLOR="#eeeeee">
			<P ALIGN=LEFT STYLE="margin-bottom: 0.51cm; border: none; padding: 0cm">
			O software do AGV foi desenvolvido em linguagem C para o microcontrolador ATmega328P e encontra se organizado por módulos de funcionalidade. No topo do programa definem se as constantes de configuração, os ganhos de controlo e os pesos atribuídos a cada sensor de linha. Em seguida são declaradas as variáveis globais usadas para guardar o estado do sistema, como o modo de funcionamento, as referências de velocidade e os contadores de pulsos dos encoders.

O código está estruturado em funções dedicadas à leitura dos sensores analógicos, ao comando dos motores em PWM, à medição da velocidade com base nos encoders, bem como em várias rotinas de interrupção associadas aos timers e às entradas externas. No final encontra se a função main, que implementa o ciclo principal do programa e a máquina de estados responsável por decidir o comportamento do veículo.
			</P>
			<P ALIGN="CENTER">
   			<IMG SRC="1.PNG" ALT="Encoders" WIDTH="300">
      			<BR>
      			<SPAN STYLE="font-size: 10pt">Figura X – Bibliotecas</SPAN>
			</P>
			<P ALIGN="CENTER">
   			<IMG SRC="tabela2.PNG" ALT="Encoders" WIDTH="1000">
      			<BR>
      			<SPAN STYLE="font-size: 10pt">Figura X – Tabela relativa às configurações dos timers e ADC</SPAN>
			</P>


			<h3>Máquina de estados e main loop</h3>
			<P ALIGN=LEFT STYLE="margin-bottom: 0.51cm">
O comportamento de alto nível do AGV é descrito por uma máquina de estados simples com dois estados principais: SEGUINDO_LINHA e PROCURAR_LINHA. A variável global estado guarda o modo de funcionamento atual.

No ciclo principal da função main o programa lê em primeiro lugar os sensores de linha através da função ler_erro_linha. Esta função devolve o erro atual em relação ao centro da pista e indica também se pelo menos um sensor detetou a linha. Quando os sensores veem a linha o sistema mantém se no estado SEGUINDO_LINHA. Quando todos os sensores passam a ver apenas fundo branco o estado muda para PROCURAR_LINHA.

No estado SEGUINDO_LINHA é calculada a correção delta a partir do erro e do ganho K_LINHA. Esta correção é somada e subtraída à velocidade base VEL_BASE para gerar as referências de velocidade vel_ref_esq e vel_ref_dir para cada roda. No estado PROCURAR_LINHA o robô executa uma manobra de procura simples, rodando em torno do próprio eixo no sentido do último erro registado, o que aumenta a probabilidade de reencontrar a pista.
			</P>
			<P ALIGN="CENTER">
   			<IMG SRC="2.0.PNG" ALT="Encoders" WIDTH="300">
      			<BR>
      			<SPAN STYLE="font-size: 10pt">Figura X – Bibliotecas</SPAN>
			</P>
			<P ALIGN="CENTER">
   			<IMG SRC="2.1.PNG" ALT="Encoders" WIDTH="300">
      			<BR>
      			<SPAN STYLE="font-size: 10pt">Figura X – Bibliotecas</SPAN>
			</P>
			<P ALIGN="CENTER">
   			<IMG SRC="flow1.PNG" ALT="Encoders" WIDTH="400">
      			<BR>
      			<SPAN STYLE="font-size: 10pt">Figura X – Flowchart relativo ao main loop</SPAN>
			</P>


			<h3>Leitura dos sensores de linha (ADC)</h3>
			<P ALIGN=LEFT STYLE="margin-bottom: 0.51cm">
A deteção da pista é feita com cinco sensores óticos de infravermelhos ligados às entradas analógicas do ATmega328P. A função init_adc configura o conversor analógico digital para usar a referência de 5 V e um prescaler que garante uma frequência de amostragem adequada.

A função ler_adc recebe como parâmetro o número do canal e devolve o valor convertido entre 0 e 1023. Com base nestes valores a função ler_erro_linha percorre os cinco sensores e compara cada leitura com o limiar THRESHOLD. Valores abaixo do limiar são considerados preto, isto é presença da fita, e contribuem para o cálculo do erro.

Para cada sensor ativo é somado o peso correspondente no array pesos_sensores. Estes pesos são simétricos em relação ao centro e assumem os valores -4, -2, 0, 2 e 4. No fim calcula se a média dos pesos ativos, o que fornece uma estimativa da posição relativa da linha. O erro devolvido pela função resulta da negação dessa média, de forma a manter a convenção de sinal usada no controlador.

Além do cálculo do erro a função atualiza ainda o LED ligado a PB5, que acende sempre que pelo menos um sensor deteta a linha. Este LED é útil em laboratório para confirmar visualmente o funcionamento do sistema de leitura.
			</P>
			<P ALIGN="CENTER">
   			<IMG SRC="3.0.PNG" ALT="Encoders" WIDTH="300">
      			<BR>
      			<SPAN STYLE="font-size: 10pt">Figura X – função init_adc</SPAN>
			</P>
			<P ALIGN="CENTER">
   			<IMG SRC="3.1.PNG" ALT="Encoders" WIDTH="300">
      			<BR>
      			<SPAN STYLE="font-size: 10pt">Figura X – função ler_adc</SPAN>
			</P>
			<P ALIGN="CENTER">
   			<IMG SRC="3.2.PNG" ALT="Encoders" WIDTH="300">
      			<BR>
      			<SPAN STYLE="font-size: 10pt">Figura X – função ler_erro_linha</SPAN>
			</P>
			<P ALIGN="CENTER">
   			<IMG SRC="flow2.PNG" ALT="Encoders" WIDTH="400">
      			<BR>
      			<SPAN STYLE="font-size: 10pt">Figura X – Flowchart relativo à função ler_erro_linha</SPAN>
			</P>

			<h3>Comando dos motores por PWM</h3>
			<P ALIGN=LEFT STYLE="margin-bottom: 0.51cm">
Cada motor de corrente contínua é comandado por um canal PWM do Timer0 do microcontrolador, através de uma ponte H. As funções set_motor_esq e set_motor_dir recebem o valor de comando em forma de duty cycle, representado por uma variável em ponto flutuante.

Dentro de cada função define se primeiro o sentido de rotação, ativando os pinos de direção da ponte H para que os motores rodem sempre para a frente. De seguida o valor de PWM é saturado entre 0 e MAX_PWM para evitar comandos fora da gama válida do hardware. Finalmente, o valor é escrito diretamente nos registos OCR0A e OCR0B, que controlam o duty cycle das saídas PWM ligadas aos motores esquerdo e direito.
			</P>
			<P ALIGN="CENTER">
   			<IMG SRC="4.0.PNG" ALT="Encoders" WIDTH="300">
      			<BR>
      			<SPAN STYLE="font-size: 10pt">Figura X – função set_motor_esq e set_motor_dir</SPAN>
			</P>
			<P ALIGN="CENTER">
   			<IMG SRC="4.1.PNG" ALT="Encoders" WIDTH="300">
      			<BR>
      			<SPAN STYLE="font-size: 10pt">Figura X – função init_hardware</SPAN>
			</P>
			<P ALIGN="CENTER">
   			<IMG SRC="flow4.PNG" ALT="Encoders" WIDTH="200">
      			<BR>
      			<SPAN STYLE="font-size: 10pt">Figura X – flowchart relativo ao comando dos motores por PWM</SPAN>
			</P>


			<h3>Leitura dos encoders e medição de velocidade</h3>
			<P ALIGN=LEFT STYLE="margin-bottom: 0.51cm">
A medição da velocidade real de cada roda é feita com encoders óticos incrementais montados nos eixos dos motores. Os sinais digitais dos encoders estão ligados às entradas externas INT0 e INT1 do ATmega328P. Cada transição produz uma interrupção que é tratada pelas rotinas ISR(INT0_vect) e ISR(INT1_vect).

Em cada interrupção o programa verifica o instante atual em milissegundos, guardado na variável tempo_ms, e compara com o instante da última contagem dessa roda. Se o tempo for diferente o contador de pulsos é incrementado. Esta verificação evita contagens repetidas no caso de ruído ou bounces elétricos.

A cada 10 ms o Timer2 gera uma interrupção de comparação. Dentro do ISR(TIMER2_COMPA_vect) é acumulado um contador interno que permite executar o cálculo da velocidade a cada 50 ms. Quando este período se completa o número de pulsos registados é convertido em rotações por minuto (RPM), tendo em conta o número de fendas do encoder e a duração do intervalo de medição. Depois de calculadas as velocidades rpm_esq e rpm_dir os contadores de pulsos são reinicializados.
			</P>
			
			<P ALIGN="CENTER">
   			<IMG SRC="5.0.PNG" ALT="Encoders" WIDTH="300">
      			<BR>
      			<SPAN STYLE="font-size: 10pt">Figura X – ISR(INT0) e ISR(INT1)</SPAN>
			</P>
			<P ALIGN="CENTER">
   			<IMG SRC="5.1.PNG" ALT="Encoders" WIDTH="300">
      			<BR>
      			<SPAN STYLE="font-size: 10pt">Figura X – excerto relativo aos encoders da função ISR(TIMER2_COMPA_vect)</SPAN>
			</P>
			<P ALIGN="CENTER">
   			<IMG SRC="flow3.PNG" ALT="Encoders" WIDTH="400">
      			<BR>
      			<SPAN STYLE="font-size: 10pt">Figura X – flowchart relativo a Encoders (INT0 e INT1)</SPAN>
			</P>

			<P ALIGN=LEFT><BR>
			</P>

			<h3>Controlador PI de velocidade</h3>
			<P ALIGN=LEFT STYLE="margin-bottom: 0.51cm">
O controlo de velocidade dos motores é realizado por um controlador do tipo PI em malha fechada, executado periodicamente dentro da interrupção do Timer2. As referências de velocidade vel_ref_esq e vel_ref_dir são definidas no ciclo principal em função do erro de linha e correspondem à velocidade desejada para cada roda.

No laço de controlo o erro de velocidade é calculado como diferença entre a referência e a velocidade medida a partir dos encoders. De seguida atualiza se o termo integral, obtido pela soma do erro vezes o intervalo de tempo dt. Para evitar acumulação excessiva a integral é limitada a um valor máximo.

O sinal de comando para cada motor é então calculado pela expressão out = KP * erro + KI * integral, onde KP e KI são os ganhos proporcional e integral do controlador. Este valor é finalmente aplicado às funções set_motor_esq e set_motor_dir, fechando a malha de controlo. Com este mecanismo os motores conseguem manter uma velocidade aproximadamente constante, compensando diferenças entre rodas e variações de carga da bateria.			</P>
			
			<P ALIGN="CENTER">
   			<IMG SRC="6.1.PNG" ALT="Encoders" WIDTH="300">
      			<BR>
      			<SPAN STYLE="font-size: 10pt">Figura X – função relativa ao controlador PI de velocidade</SPAN>
			</P>
			

			<P ALIGN=LEFT><BR>
			</P>

<h3>Timers auxiliares e funções de debug</h3>
			<P ALIGN=LEFT STYLE="margin-bottom: 0.51cm">
Além do Timer0, usado para gerar os sinais PWM, e do Timer2, responsável pelo controlo de velocidade, foi também configurado o Timer1 em modo normal com overflow para piscar periodicamente um LED de diagnóstico. A rotina ISR(TIMER1_OVF_vect) recarrega o contador com o valor inicial correspondente a 500 ms e alterna o estado de um pino digital ligado ao LED. Como a interrupção ocorre a cada 500 ms e o LED é alternado a cada interrupção, obtém-se um piscar de 1 Hz. Este indicador permite confirmar que o microcontrolador está em execução e que as interrupções de temporização estão a ocorrer com a frequência prevista, facilitando a deteção de bloqueios de software durante os testes.		</P>
			
			<P ALIGN="CENTER">
   			<IMG SRC="7.0.PNG" ALT="Encoders" WIDTH="300">
      			<BR>
      			<SPAN STYLE="font-size: 10pt">Figura X – Rotina de interrupção ISR(TIMER1_OVF_vect) para o LED de diagnóstico</SPAN>
			</P>
			<P ALIGN="CENTER">
   			<IMG SRC="7.1.PNG" ALT="Encoders" WIDTH="300">
      			<BR>
      			<SPAN STYLE="font-size: 10pt">Figura X – Configuração do Timer1 (modo normal e overflow) na função init_hardware</SPAN>
			</P>

			<P ALIGN=LEFT><BR>
			</P>

<h2>Configurações</h2>

<h3>Timer0</h3>


<p>O Timer0 é utilizado para gerar PWM (Fast PWM) para os dois motores, através das saídas OC0A e OC0B, com prescaler 64.</p>



			<P ALIGN="CENTER" STYLE="margin-bottom: 50px;">
			<b>TCCR0A</b><br>
   			<IMG SRC="TCCR0A.png" ALT="Encoders" WIDTH="550">
      			<BR>
      			<SPAN STYLE="font-size: 10pt">Tabela X – Registo TCCR0A</SPAN>
			</P>

			<P ALIGN="CENTER" STYLE="margin-bottom: 50px;">
			<b>TCCR0B</b><br>
   			<IMG SRC="TCCR0B.png" ALT="Encoders" WIDTH="550">
      			<BR>
      			<SPAN STYLE="font-size: 10pt">Tabela X – Registo TCCR0B</SPAN>
			</P>




<ul class="cfg-bullets">
  <li><b>Modo:</b> Fast PWM (WGM02:0 = 3), TOP = 0xFF</li>
  <li><b>Saídas PWM:</b> OC0A e OC0B em modo não inversor (duty definido por OCR0A e OCR0B)</li>
  <li><b>Prescaler:</b> 64 (CS02:0 = 011)</li>
  <li><b>Frequência:</b> ~ 976,6 Hz</li>
  <li><b>Interrupções:</b> não utilizadas no Timer0 (TIMSK0 sem enables)</li>
</ul>


<h3>Timer2</h3>


<p>O Timer2 é usado como base de tempo do sistema. Está configurado em modo CTC, com prescaler 1024 e OCR2A = 155, gerando uma interrupção a cada ~10 ms (usada para atualizar o tempo e lançar o controlo de velocidade).</p>



<P ALIGN="CENTER" STYLE="margin-bottom: 50px;">
  <b>TCCR2A</b><br>
  <IMG SRC="TCCR2A.png" ALT="Registo TCCR2A" WIDTH="550">
  <BR>
  <SPAN STYLE="font-size: 10pt">Tabela X – Registo TCCR2A</SPAN>
</P>

<P ALIGN="CENTER" STYLE="margin-bottom: 50px;">
  <b>TCCR2B</b><br>
  <IMG SRC="TCCR2B.png" ALT="Registo TCCR2B" WIDTH="550">
  <BR>
  <SPAN STYLE="font-size: 10pt">Tabela X – Registo TCCR2B</SPAN>
</P>

<P ALIGN="CENTER" STYLE="margin-bottom: 50px;">
  <b>TIMSK2</b><br>
  <IMG SRC="TIMSK2.png" ALT="Registo TIMSK2" WIDTH="550">
  <BR>
  <SPAN STYLE="font-size: 10pt">Tabela X – Registo TIMSK2</SPAN>
</P>





<ul class="cfg-bullets">
  <li><b>Modo:</b> CTC (WGM22:0 = 2), TOP = OCR2A</li>
  <li><b>Prescaler:</b> 1024 (CS22:0 = 111)</li>
  <li><b>Valor OCR2A:</b> 155</li>
  <li><b>Período:</b> ~ 9,984 ms (≈ 10 ms)</li>
  <li><b>Interrupções:</b> Compare Match A ativo (OCIE2A = 1)</li>
</ul>





<h3>Timer1</h3>

<p>
  O Timer1 é usado como base de tempo para fazer piscar um LED de debug em PD1.
  O timer está em modo Normal, com prescaler 1024, e é feito preload de TCNT1 para obter overflow a cada ~500 ms.
  Em cada overflow, a ISR alterna o estado do LED, resultando num piscar a ~1 Hz.
</p>

<P ALIGN="CENTER" STYLE="margin-bottom: 50px;">
  <b>TCCR1A</b><br>
  <IMG SRC="TCCR1A.png" ALT="Registo TCCR1A" WIDTH="550">
  <BR>
  <SPAN STYLE="font-size: 10pt">Tabela X – Registo TCCR1A</SPAN>
</P>

<P ALIGN="CENTER" STYLE="margin-bottom: 50px;">
  <b>TCCR1B</b><br>
  <IMG SRC="TCCR1B.png" ALT="Registo TCCR1B" WIDTH="550">
  <BR>
  <SPAN STYLE="font-size: 10pt">Tabela X – Registo TCCR1B</SPAN>
</P>

<P ALIGN="CENTER" STYLE="margin-bottom: 50px;">
  <b>TIMSK1</b><br>
  <IMG SRC="TIMSK1.png" ALT="Registo TIMSK1" WIDTH="550">
  <BR>
  <SPAN STYLE="font-size: 10pt">Tabela X – Registo TIMSK1</SPAN>
</P>

<ul class="cfg-bullets">
  <li><b>Modo:</b> Normal (WGM13:0 = 0), TOP = 0xFFFF</li>
  <li><b>Prescaler:</b> 1024 (CS12:0 = 101)</li>
  <li><b>Preload:</b> TCNT1 = 57724, overflow a cada ~500 ms</li>
  <li><b>Interrupções:</b> Overflow ativo (TOIE1 = 1)</li>
  <li><b>Função:</b> alterna PD1 na ISR, piscar do LED a ~1 Hz</li>
</ul>



		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD COLSPAN=11 WIDTH=94%>
			<UL>
				<LI><P ALIGN=LEFT STYLE="background: #0099ff; border: none; padding: 0cm"><A NAME="Resultados"></A>
				<FONT SIZE=4>Resultados</FONT></P>
			</UL>
		</TD>
		<TD WIDTH=6%>
			<P ALIGN=CENTER STYLE="border: none; padding: 0cm"><A HREF="#In&iacute;cio"><FONT COLOR="#000000"><SPAN STYLE="text-decoration: none"><FONT FACE="Thorndale, serif"><FONT SIZE=2><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">In&iacute;cio</SPAN></SPAN></FONT></FONT></SPAN></FONT></A></P>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=12 WIDTH=100% VALIGN=TOP BGCOLOR="#eeeeee">
			<P ALIGN=LEFT STYLE="margin-bottom: 0.51cm; border: none; padding: 0cm">
			O sistema foi testado na pista fornecida no laboratório, com uma linha preta
sobre fundo branco e secções de recta e curva. Foram realizadas várias
experiências com diferentes valores de velocidade de referência e de ganhos
do controlador.
			</P>
			<P ALIGN=LEFT STYLE="margin-bottom: 0.51cm">
Com o controlador de velocidade activo, as duas rodas conseguem manter uma
velocidade média próxima do valor de referência definido, por exemplo cerca
de 30 a 60 RPM, mesmo com pequenas diferenças mecânicas entre motores.
A medição da velocidade foi validada experimentalmente, marcando a roda com
uma referência visual e contando o número de rotações por minuto com recurso
a um cronómetro.
			</P>
			<P ALIGN=LEFT STYLE="margin-bottom: 0.51cm">
O robot consegue seguir a linha de forma estável ao longo de voltas completas
à pista, sem sair para o exterior. Observam se ainda pequenas oscilações na
velocidade, sobretudo para referências muito baixas, o que está relacionado
com a resolução limitada dos encoders e com a frequência de amostragem
utilizada. Apesar disso, o comportamento global é adequado ao objectivo do
trabalho.
			</P>
			<P ALIGN=LEFT><BR>
			</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD COLSPAN=11 WIDTH=94%>
			<UL>
				<LI><P ALIGN=LEFT STYLE="background: #0099ff; border: none; padding: 0cm"><A NAME="Conclus&otilde;es"></A>
				<FONT SIZE=4>Conclus&otilde;es</FONT></P>
			</UL>
		</TD>
		<TD WIDTH=6%>
			<P ALIGN=CENTER STYLE="border: none; padding: 0cm"><A HREF="#In&iacute;cio"><FONT COLOR="#000000"><SPAN STYLE="text-decoration: none"><FONT FACE="Thorndale, serif"><FONT SIZE=2><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">In&iacute;cio</SPAN></SPAN></FONT></FONT></SPAN></FONT></A></P>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=12 WIDTH=100% VALIGN=TOP BGCOLOR="#eeeeee">
			<P ALIGN=LEFT STYLE="margin-bottom: 0.51cm; border: none; padding: 0cm">
			O robot consegue seguir a linha de forma estável ao longo de voltas completas
à pista, sem sair para o exterior. Observam se ainda pequenas oscilações na
velocidade, sobretudo para referências muito baixas, o que está relacionado
com a resolução limitada dos encoders e com a frequência de amostragem
utilizada. Apesar disso, o comportamento global é adequado ao objectivo do
trabalho.
			</P>
			<P ALIGN=LEFT STYLE="margin-bottom: 0.51cm">
A utilização dos encoders mostrou se fundamental para compensar diferenças
entre motores e variações de tensão da bateria. Também revelou algumas
limitações, nomeadamente a resolução relativamente baixa em RPM e a
necessidade de cuidar da prioridade e da duração das rotinas de interrupção
para evitar perda de pulsos.
			</P>
			<P ALIGN=LEFT STYLE="margin-bottom: 0.51cm">
Como trabalho futuro podem ser exploradas melhorias ao algoritmo de controlo
de seguimento de linha introduzindo uma componente derivativa, filtros para
reduzir ruído nas medições dos encoders e estratégias mais avançadas de
procura da linha quando esta é perdida. Outra possibilidade é substituir o
driver L293D por um módulo de maior eficiência, bem como desenhar uma placa
dedicada para reduzir ligações em breadboard.	
			</P>
			<P ALIGN=LEFT><BR>
			</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD COLSPAN=11 WIDTH=94%>
			<UL>
				<LI><P ALIGN=LEFT STYLE="background: #0099ff; border: none; padding: 0cm"><A NAME="Refer&ecirc;ncias"></A>
				<FONT SIZE=4>Refer&ecirc;ncias</FONT></P>
			</UL>
		</TD>
		<TD WIDTH=6%>
			<P ALIGN=CENTER STYLE="border: none; padding: 0cm"><A HREF="#In&iacute;cio"><FONT COLOR="#000000"><SPAN STYLE="text-decoration: none"><FONT FACE="Thorndale, serif"><FONT SIZE=2><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">In&iacute;cio</SPAN></SPAN></FONT></FONT></SPAN></FONT></A></P>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=12 WIDTH=100% VALIGN=TOP BGCOLOR="#eeeeee">
			<P ALIGN=LEFT STYLE="margin-bottom: 0.51cm; border: none; padding: 0cm"><A NAME="_Ref153776170"></A><A NAME="_Ref152167798"></A>
			<SPAN LANG="en-US">[1]</SPAN> <SPAN LANG="en-US">Alcatel</SPAN>&mdash;<SPAN LANG="en-US"><I>SAM-O
			Service Aware Manager Open Interface, Release 3.0, OSS Interface
			Developer Guide</I></SPAN><SPAN LANG="en-US">. Alcatel, 2005.</SPAN></P>
			<P STYLE="margin-bottom: 0.5cm"><A NAME="_Ref153776244"></A>[2]
			AZEVEDO, Carlos; AZEVEDO, Ana&mdash;<I>Metodologia Cient&iacute;fica:
			contributos pr&aacute;ticos para a elabora&ccedil;&atilde;o de
			trabalhos acad&eacute;micos</I>. 3&ordf; ed. Porto: Ed. C.
			Azevedo, 1996. pp 67-91</P>
			<P STYLE="margin-bottom: 0.5cm"><A NAME="_Ref153776279"></A><SPAN LANG="en-GB">[3]</SPAN>
			<SPAN LANG="de-DE">Hofmann, Alfred; Barth, Ursula; Beyer, Ingrid;
			G&uuml;nther, Christine; </SPAN><SPAN LANG="en-GB">Holzwarth,
			Frank; Kramer, Anna; </SPAN><SPAN LANG="de-DE">Siebert-Cole</SPAN><SPAN LANG="en-GB">,
			</SPAN><SPAN LANG="de-DE">Erika</SPAN>&mdash;<SPAN LANG="en-US"><I>Lecture
			Notes in Computer Science: Authors&rsquo; Instructions for the
			Preparation of Camera-Ready Contributions to LNCS/LNAI/LNBI
			Proceedings</I></SPAN><SPAN LANG="en-US">.</SPAN> <SPAN LANG="de-DE">Springer-Verlag,
			Computer Science Editorial, Tiergartenstr. 17, 69121 Heidelberg,
			Germany</SPAN></P>
			<P STYLE="margin-bottom: 0.5cm"><A NAME="_Ref153776394"></A><A NAME="_Ref117412991"></A>
			<SPAN LANG="en-GB">[4]</SPAN> <SPAN LANG="en-GB">Mauro, Douglas;
			Schmidt, Kevin&mdash;</SPAN><SPAN LANG="en-GB"><I>Essential SNMP,
			Help for System and Network Administrators</I></SPAN><SPAN LANG="en-GB">.
			O&rsquo;Reilly, 2001. ISBN 0-596-00020-0.</SPAN></P>
			<P STYLE="margin-bottom: 0.5cm"><A NAME="_Ref152182530"></A><SPAN LANG="en-US">[5]</SPAN>
			<SPAN LANG="en-US">Net-SNMP, Version:&nbsp; 5.2.1,
			</SPAN><A HREF="http://www.net-snmp.org/"><SPAN STYLE="text-decoration: none"><SPAN LANG="en-US">http://www.net-snmp.org/</SPAN></SPAN></A></P>
			<P STYLE="margin-bottom: 0.5cm"><A NAME="_Ref153776459"></A>[6]
			PINTO, J. A. Cardoso&mdash;<I>RETA, Manual de Refer&ecirc;ncia</I>.
			PT-Comunica&ccedil;&otilde;es, 2004.</P>
			<P ALIGN=LEFT STYLE="border: none; padding: 0cm"><BR>
			</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD COLSPAN=11 WIDTH=94%>
			<P ALIGN=LEFT STYLE="background: #0099ff"><BR>
			</P>
		</TD>
		<TD WIDTH=6%>
			<P ALIGN=CENTER STYLE="background: transparent; border: none; padding: 0cm">
			<A HREF="#In&iacute;cio"><FONT COLOR="#000000"><SPAN STYLE="text-decoration: none"><FONT FACE="Thorndale, serif"><FONT SIZE=2><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">In&iacute;cio</SPAN></SPAN></FONT></FONT></SPAN></FONT></A></P>
		</TD>
	</TR>
</TABLE>
<P ALIGN=LEFT><BR><BR>
</P>
<P ALIGN=LEFT><BR><BR>
</P>
<P ALIGN=LEFT><BR><BR>
</P>
<P ALIGN=LEFT><BR><BR>
</P>
<P ALIGN=CENTER><BR><BR>
</P>
</BODY>
</HTML>